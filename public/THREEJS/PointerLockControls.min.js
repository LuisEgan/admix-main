THREE.PointerLockControls=function(e){var t=this,n=!1,o=!1,a=!1,c=!1,r=!1,i=!1,d=!1,s=!1,l=new THREE.Vector3,u=performance.now(),m=e;m.rotation.set(0,0,0);var v=new THREE.Object3D;v.add(m);var E=new THREE.Object3D;E.position.y=0,E.add(v);var y,w,b=Math.PI/2,h=function(e){e.preventDefault(),e.deltaY<0?n=!0:e.deltaY>0?o=!0:(n=!1,o=!1)},k=function(e){if(!1!==t.enabled){var n=e.movementX||e.mozMovementX||e.webkitMovementX||0,o=e.movementY||e.mozMovementY||e.webkitMovementY||0;t.wheelClick?(document.body.style.cursor="move",n>0?(i=!1,r=!0):n<0&&(r=!1,i=!0),o>0?(s=!1,d=!0):o<0&&(d=!1,s=!0)):(E.rotation.y-=.002*n,v.rotation.x-=.002*o,v.rotation.x=Math.max(-b,Math.min(b,v.rotation.x)))}};this.noRotation=function(){document.body.style.cursor="default",document.removeEventListener("mousemove",k,!1),document.removeEventListener("wheel",h,!1)},this.yesRotation=function(){document.body.style.cursor="alias",document.addEventListener("mousemove",k,!1),document.addEventListener("wheel",h,!1)},document.addEventListener("wheel",h,!1),document.addEventListener("mousemove",k,!1),document.addEventListener("mouseup",function(e){t.wheelClick&&(document.body.style.cursor="alias"),t.enabled=!1,t.wheelClick=!1,i=!1,r=!1,d=!1,s=!1},!1),document.addEventListener("mousedown",function(e){e.preventDefault(),t.enabled=!0,2===e.which&&(t.wheelClick=!0)},!1),document.addEventListener("keydown",function(e){if("input"!=(e.target||e.srcElement).nodeName.toLowerCase())switch(e.keyCode){case 38:case 87:a=!0;break;case 37:case 65:r=!0;break;case 40:case 83:c=!0;break;case 39:case 68:i=!0;break;case 81:d=!0;break;case 69:s=!0}},!1),document.addEventListener("keyup",function(e){switch(e.keyCode){case 38:case 87:a=!1;break;case 37:case 65:r=!1;break;case 40:case 83:c=!1;break;case 39:case 68:i=!1;break;case 81:d=!1;break;case 69:s=!1}},!1),this.enabled=!1,this.getObject=function(){return E},this.getDirection=(y=new THREE.Vector3(0,0,-1),w=new THREE.Euler(0,0,0,"YXZ"),function(e){return w.set(v.rotation.x,E.rotation.y,0),e.copy(y).applyEuler(w),e}),this.update=function(){var e=performance.now(),m=(e-u)/1e3,v=n||o?5:.5;l.x-=10*l.x*m,l.z-=10*l.z*m,l.y-=10*l.y*m;var E=new THREE.Vector3;a&&(E=t.getDirection(E),l.add(E.multiplyScalar(v*m))),n&&(E=t.getDirection(E),l.add(E.multiplyScalar(v*m)),n=!1),c&&(E=t.getDirection(E),l.add(E.multiplyScalar(-v*m))),o&&(E=t.getDirection(E),l.add(E.multiplyScalar(-v*m)),o=!1),r&&((E=t.getDirection(E)).cross(new THREE.Vector3(0,1,0)).normalize(),l.add(E.multiplyScalar(-v*m))),i&&((E=t.getDirection(E)).cross(new THREE.Vector3(0,1,0)).normalize(),l.add(E.multiplyScalar(v*m))),d&&(E.set(0,1,0),l.add(E.multiplyScalar(v*m))),s&&(E.set(0,1,0),l.add(E.multiplyScalar(-v*m))),t.getObject().position.add(l),u=e}};