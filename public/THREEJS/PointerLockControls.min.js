THREE.PointerLockControls=function(e){var t=this,n=!1,o=!1,a=!1,r=!1,i=!1,c=!1,d=!1,s=!1,m=new THREE.Vector3,u=performance.now(),l=e;l.rotation.set(0,0,0);var v=new THREE.Object3D;v.add(l);var E=new THREE.Object3D;E.position.y=0,E.add(v);var w,p,y=Math.PI/2,h=function(e){e.preventDefault(),e.deltaY<0?n=!0:e.deltaY>0?o=!0:(n=!1,o=!1)},k=function(e){if(!1!==t.enabled){var n=e.movementX||e.mozMovementX||e.webkitMovementX||0,o=e.movementY||e.mozMovementY||e.webkitMovementY||0;t.wheelClick?(document.body.style.cursor="move",n>0?(c=!1,i=!0):n<0&&(i=!1,c=!0),o>0?(s=!1,d=!0):o<0&&(d=!1,s=!0)):(E.rotation.y-=.002*n,v.rotation.x-=.002*o,v.rotation.x=Math.max(-y,Math.min(y,v.rotation.x)))}},L=function(e){t.wheelClick&&(document.body.style.cursor="default"),t.enabled=!1,t.wheelClick=!1,c=!1,i=!1,d=!1,s=!1},b=function(e){e.preventDefault(),t.enabled=!0,2===e.which&&(t.wheelClick=!0)},f=function(e){if(e.preventDefault(),e.stopImmediatePropagation(),"input"!=(e.target||e.srcElement).nodeName.toLowerCase())switch(e.keyCode){case 38:case 87:a=!0;break;case 37:case 65:i=!0;break;case 40:case 83:r=!0;break;case 39:case 68:c=!0;break;case 81:d=!0;break;case 69:s=!0}},D=function(e){switch(e.keyCode){case 38:case 87:a=!1;break;case 37:case 65:i=!1;break;case 40:case 83:r=!1;break;case 39:case 68:c=!1;break;case 81:d=!1;break;case 69:s=!1}};this.noRotation=function(){document.removeEventListener("mousemove",k,!1),document.removeEventListener("wheel",h,!1)},this.yesRotation=function(){document.addEventListener("mousemove",k,!1),document.addEventListener("wheel",h,!1)},this.dispose=function(){document.removeEventListener("wheel",h,!1),document.removeEventListener("mousemove",k,!1),document.removeEventListener("mouseup",L,!1),document.removeEventListener("mousedown",b,!1),document.removeEventListener("keydown",f,!1),document.removeEventListener("keyup",D,!1)},this.enable=function(){document.addEventListener("wheel",h,!1),document.addEventListener("mousemove",k,!1),document.addEventListener("mouseup",L,!1),document.addEventListener("mousedown",b,!1),document.addEventListener("keydown",f,!1),document.addEventListener("keyup",D,!1)},document.addEventListener("wheel",h,!1),document.addEventListener("mousemove",k,!1),document.addEventListener("mouseup",L,!1),document.addEventListener("mousedown",b,!1),document.addEventListener("keydown",f,!1),document.addEventListener("keyup",D,!1),this.enabled=!1,this.getObject=function(){return E},this.getDirection=(w=new THREE.Vector3(0,0,-1),p=new THREE.Euler(0,0,0,"YXZ"),function(e){return p.set(v.rotation.x,E.rotation.y,0),e.copy(w).applyEuler(p),e}),this.update=function(){var e=performance.now(),l=(e-u)/1e3,v=n||o?18:5;m.x-=10*m.x*l,m.z-=10*m.z*l,m.y-=10*m.y*l;var E=new THREE.Vector3;a&&(E=t.getDirection(E),m.add(E.multiplyScalar(v*l))),n&&(E=t.getDirection(E),m.add(E.multiplyScalar(v*l)),n=!1),r&&(E=t.getDirection(E),m.add(E.multiplyScalar(-v*l))),o&&(E=t.getDirection(E),m.add(E.multiplyScalar(-v*l)),o=!1),i&&((E=t.getDirection(E)).cross(new THREE.Vector3(0,1,0)).normalize(),m.add(E.multiplyScalar(-v*l))),c&&((E=t.getDirection(E)).cross(new THREE.Vector3(0,1,0)).normalize(),m.add(E.multiplyScalar(v*l))),d&&(E.set(0,1,0),m.add(E.multiplyScalar(v*l))),s&&(E.set(0,1,0),m.add(E.multiplyScalar(-v*l))),t.getObject().position.add(m),u=e}};